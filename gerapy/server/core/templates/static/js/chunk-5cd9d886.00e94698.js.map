{"version":3,"sources":["webpack:///./src/views/project/Edit.vue?9076","webpack:///./src/views/project/Edit.vue?88c9","webpack:///src/views/project/Edit.vue","webpack:///./src/views/project/Edit.vue?135e","webpack:///./src/views/project/Edit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","projectName","tree","defaultProps","on","onNodeClick","basename","activeFile","onRenameFile","_v","_s","$lang","buttons","rename","_e","onCreateFile","create","onDeleteFile","delete","editorOptions","onEditorCodeChange","model","value","callback","$$v","code","expression","staticRenderFns","name","data","clientData","loading","children","label","activeNode","modeMap","py","js","html","vue","md","scss","css","php","tabSize","mode","theme","lineNumbers","styleActiveLine","line","keyMap","extraKeys","Tab","foldGutter","gutters","styleSelectedText","highlightSelectionMatches","showToken","annotateScrollbar","components","PanelTitle","codemirror","created","methods","getProjectTree","get","then","_this","catch","onChangeCode","post","_this2","confirmButtonText","cancelButtonText","inputValue","inputPattern","inputErrorMessage","_this3","path","pre","new","_this4","type","_this5","_this6","component"],"mappings":"gHAAA,W,gECAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACA,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,IAAI,CAACF,EAAG,MAAM,CAACG,YAAY,QAAQD,MAAM,CAAC,GAAK,SAAS,CAACF,EAAG,cAAc,CAACE,MAAM,CAAC,MAAQN,EAAIQ,eAAeJ,EAAG,MAAM,CAACG,YAAY,cAAc,CAACH,EAAG,UAAU,CAACE,MAAM,CAAC,KAAON,EAAIS,KAAK,MAAQT,EAAIU,cAAcC,GAAG,CAAC,aAAaX,EAAIY,gBAAgB,IAAI,KAAKR,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,KAAK,CAACF,EAAG,MAAM,CAACG,YAAY,gBAAgB,CAACH,EAAG,cAAc,CAACE,MAAM,CAAC,MAAQN,EAAIa,SAASb,EAAIc,cAAc,CAAEd,EAAc,WAAEI,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,OAAO,KAAO,WAAWK,GAAG,CAAC,MAAQX,EAAIe,eAAe,CAACX,EAAG,IAAI,CAACG,YAAY,eAAeP,EAAIgB,GAAG,eAAehB,EAAIiB,GAAGjB,EAAIkB,MAAMC,QAAQC,QAAQ,gBAAgBpB,EAAIqB,KAAMrB,EAAc,WAAEI,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,OAAO,KAAO,QAAQK,GAAG,CAAC,MAAQX,EAAIsB,eAAe,CAAClB,EAAG,IAAI,CAACG,YAAY,eAAeP,EAAIgB,GAAG,eAAehB,EAAIiB,GAAGjB,EAAIkB,MAAMC,QAAQI,QAAQ,gBAAgBvB,EAAIqB,KAAMrB,EAAc,WAAEI,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,OAAO,KAAO,UAAUK,GAAG,CAAC,MAAQX,EAAIwB,eAAe,CAACpB,EAAG,IAAI,CAACG,YAAY,gBAAgBP,EAAIgB,GAAG,eAAehB,EAAIiB,GAAGjB,EAAIkB,MAAMC,QAAQM,QAAQ,gBAAgBzB,EAAIqB,MAAM,GAAGjB,EAAG,MAAM,CAACG,YAAY,cAAc,CAACH,EAAG,aAAa,CAACE,MAAM,CAAC,QAAUN,EAAI0B,eAAef,GAAG,CAAC,MAAQX,EAAI2B,oBAAoBC,MAAM,CAACC,MAAO7B,EAAQ,KAAE8B,SAAS,SAAUC,GAAM/B,EAAIgC,KAAKD,GAAKE,WAAW,WAAW,IAAI,MAAM,IAC33CC,EAAkB,G,8CCoHP,G,2UAAA,CACfC,mBACAC,gBACA,OACA5B,oCACA6B,gBACAC,WACA7B,QACAC,cACA6B,oBACAC,eAEA1B,gBACA2B,gBACAT,6CACAU,SACAC,mBACAC,qBACAC,iBACAC,iBACAC,qBACAC,mBACAC,iBACAC,+BAEAxB,eACAyB,UACAC,uBACAC,gBACAC,eACAC,mBACAC,QACAC,iBAEAC,WACAC,oBAGAC,cACAC,2DAEAC,qBACAC,2BACAC,eACAC,yBAKAC,YACAC,kBACAC,4BAEAC,mBACA,uCAEAC,SACAC,2BAAA,WAEA,WACAC,IACA,sDACArC,UAGAsC,kBAAA,aAEA,GADAC,SACA,iBACA,8BACAA,qBAGAC,kBACAD,gEAGA9D,wBACA,kBACA,qBACA,uEAGAgE,yBAAA,WAEA,mCACA,gBAEA,wCAEA,YACA,WACAC,+CACAJ,kBAAA,aACAK,YAEAH,kBACAG,gEAIA/D,wBAAA,WACA,aACA,4CACA,0CACA,CACAgE,wDACAC,sDACAC,iCACAC,sBACAC,mEAEA,gCACAC,QACAP,4CACAQ,uBACAC,uBACAC,QAEAd,iBACAW,mBACAA,6CAEAA,mCAEAT,kBACAS,mEAIA9D,wBAAA,WACA,aACA,4CACA,0CACA,CACAyD,wDACAC,sDACAC,iCACAC,sBACAC,mEAEA,gCACAK,QACAX,4CACAQ,uBACAlD,SAEAsC,iBACAe,mBACAA,6CAEAA,mCAEAb,kBACAa,mEAIAhE,wBAAA,WACA,cACA,2CACA,0CACA,CACAuD,wDACAC,sDACAS,iBAEA,iBACAC,QACAb,4CACAQ,uBACA7C,2BAEAiC,iBACAiB,mBACAA,+CAEAA,mCAEAf,kBACAe,qEAIA/D,iCAAA,WACA,WACAkD,+CACA7C,OACAqD,6BACA7C,iCAEAiC,iBACA,GACA3C,OAGA6C,kBACAgB,qECzT6V,I,wBCQzVC,EAAY,eACd,EACA7F,EACAmC,GACA,EACA,KACA,KACA,MAIa,aAAA0D,E","file":"static/js/chunk-5cd9d886.00e94698.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Edit.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-row',[_c('el-col',{attrs:{\"span\":4}},[_c('div',{staticClass:\"panel\",attrs:{\"id\":\"tree\"}},[_c('panel-title',{attrs:{\"title\":_vm.projectName}}),_c('div',{staticClass:\"panel-body\"},[_c('el-tree',{attrs:{\"data\":_vm.tree,\"props\":_vm.defaultProps},on:{\"node-click\":_vm.onNodeClick}})],1)],1)]),_c('el-col',{attrs:{\"span\":20}},[_c('div',{staticClass:\"panel m-l-md\"},[_c('panel-title',{attrs:{\"title\":_vm.basename(_vm.activeFile)}},[(_vm.activeFile)?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":_vm.onRenameFile}},[_c('i',{staticClass:\"fa fa-edit\"}),_vm._v(\"\\n          \"+_vm._s(_vm.$lang.buttons.rename)+\"\\n        \")]):_vm._e(),(_vm.activeFile)?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"info\"},on:{\"click\":_vm.onCreateFile}},[_c('i',{staticClass:\"fa fa-plus\"}),_vm._v(\"\\n          \"+_vm._s(_vm.$lang.buttons.create)+\"\\n        \")]):_vm._e(),(_vm.activeFile)?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":_vm.onDeleteFile}},[_c('i',{staticClass:\"fa fa-close\"}),_vm._v(\"\\n          \"+_vm._s(_vm.$lang.buttons.delete)+\"\\n        \")]):_vm._e()],1),_c('div',{staticClass:\"panel-body\"},[_c('codemirror',{attrs:{\"options\":_vm.editorOptions},on:{\"input\":_vm.onEditorCodeChange},model:{value:(_vm.code),callback:function ($$v) {_vm.code=$$v},expression:\"code\"}})],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-row>\r\n    <el-col :span=\"4\">\r\n      <div class=\"panel\" id=\"tree\">\r\n        <panel-title :title=\"projectName\"> </panel-title>\r\n        <div class=\"panel-body\">\r\n          <el-tree\r\n            :data=\"tree\"\r\n            :props=\"defaultProps\"\r\n            @node-click=\"onNodeClick\"\r\n          ></el-tree>\r\n        </div>\r\n      </div>\r\n    </el-col>\r\n    <el-col :span=\"20\">\r\n      <div class=\"panel m-l-md\">\r\n        <panel-title :title=\"basename(activeFile)\">\r\n          <el-button\r\n            @click=\"onRenameFile\"\r\n            size=\"mini\"\r\n            type=\"primary\"\r\n            v-if=\"activeFile\"\r\n          >\r\n            <i class=\"fa fa-edit\"></i>\r\n            {{ $lang.buttons.rename }}\r\n          </el-button>\r\n          <el-button\r\n            @click=\"onCreateFile\"\r\n            size=\"mini\"\r\n            type=\"info\"\r\n            v-if=\"activeFile\"\r\n          >\r\n            <i class=\"fa fa-plus\"></i>\r\n            {{ $lang.buttons.create }}\r\n          </el-button>\r\n          <el-button\r\n            @click=\"onDeleteFile\"\r\n            size=\"mini\"\r\n            type=\"danger\"\r\n            v-if=\"activeFile\"\r\n          >\r\n            <i class=\"fa fa-close\"></i>\r\n            {{ $lang.buttons.delete }}\r\n          </el-button>\r\n        </panel-title>\r\n        <div class=\"panel-body\">\r\n          <codemirror\r\n            v-model=\"code\"\r\n            :options=\"editorOptions\"\r\n            @input=\"onEditorCodeChange\"\r\n          >\r\n          </codemirror>\r\n        </div>\r\n      </div>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n<script>\r\nimport PanelTitle from \"../../components/PanelTitle\";\r\nimport { codemirror } from \"vue-codemirror\";\r\n\r\n// Theme\r\nimport \"codemirror/theme/monokai.css\";\r\n\r\n// Base Style\r\nimport \"codemirror/lib/codemirror.css\";\r\n\r\n// Extra Keys\r\nimport \"codemirror/addon/hint/show-hint\";\r\nimport \"codemirror/addon/hint/javascript-hint\";\r\nimport \"codemirror/addon/hint/sql-hint\";\r\nimport \"codemirror/addon/hint/html-hint\";\r\nimport \"codemirror/addon/hint/xml-hint\";\r\nimport \"codemirror/addon/hint/anyword-hint\";\r\nimport \"codemirror/addon/hint/css-hint\";\r\nimport \"codemirror/addon/hint/show-hint\";\r\n\r\n// Key Map\r\nimport \"codemirror/keymap/sublime\";\r\n\r\n// CloseBrackets\r\nimport \"codemirror/addon/edit/closebrackets\";\r\n\r\n// Active Line\r\nimport \"codemirror/addon/selection/active-line\";\r\n\r\n// StyleSelectedText\r\nimport \"codemirror/addon/selection/mark-selection\";\r\nimport \"codemirror/addon/search/searchcursor\";\r\n\r\n// Hint\r\nimport \"codemirror/addon/hint/show-hint\";\r\nimport \"codemirror/addon/hint/show-hint.css\";\r\nimport \"codemirror/addon/hint/anyword-hint\";\r\n\r\n// foldGutter\r\nimport \"codemirror/addon/fold/foldgutter.css\";\r\nimport \"codemirror/addon/fold/brace-fold\";\r\nimport \"codemirror/addon/fold/comment-fold\";\r\nimport \"codemirror/addon/fold/foldcode\";\r\nimport \"codemirror/addon/fold/foldgutter\";\r\nimport \"codemirror/addon/fold/indent-fold\";\r\nimport \"codemirror/addon/fold/markdown-fold\";\r\nimport \"codemirror/addon/fold/xml-fold\";\r\n\r\n// Mode\r\nimport \"codemirror/mode/css/css\";\r\nimport \"codemirror/mode/dockerfile/dockerfile\";\r\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\r\nimport \"codemirror/mode/markdown/markdown\";\r\nimport \"codemirror/mode/php/php\";\r\nimport \"codemirror/mode/python/python\";\r\nimport \"codemirror/mode/sass/sass\";\r\nimport \"codemirror/mode/javascript/javascript\";\r\nimport \"codemirror/mode/sql/sql\";\r\nimport \"codemirror/mode/vue/vue\";\r\n\r\nexport default {\r\n  name: \"projectEdit\",\r\n  data() {\r\n    return {\r\n      projectName: this.$route.params.name,\r\n      clientData: null,\r\n      loading: true,\r\n      tree: [],\r\n      defaultProps: {\r\n        children: \"children\",\r\n        label: \"label\",\r\n      },\r\n      activeFile: null,\r\n      activeNode: null,\r\n      code: \"Please Choose File from Left to Edit.\",\r\n      modeMap: {\r\n        py: \"text/x-python\",\r\n        js: \"text/javascript\",\r\n        html: \"text/html\",\r\n        vue: \"text/x-vue\",\r\n        md: \"text/x-markdown\",\r\n        scss: \"text/x-sass\",\r\n        css: \"text/x-css\",\r\n        php: \"application/x-httpd-php\",\r\n      },\r\n      editorOptions: {\r\n        tabSize: 4,\r\n        mode: \"text/javascript\",\r\n        theme: \"monokai\",\r\n        lineNumbers: true,\r\n        styleActiveLine: true,\r\n        line: true,\r\n        keyMap: \"sublime\",\r\n        // 按键映射，比如Ctrl键映射autocomplete，autocomplete是hint代码提示事件\r\n        extraKeys: {\r\n          Tab: \"autocomplete\",\r\n        },\r\n        // 代码折叠\r\n        foldGutter: true,\r\n        gutters: [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"],\r\n        // 选中文本自动高亮，及高亮方式\r\n        styleSelectedText: true,\r\n        highlightSelectionMatches: {\r\n          showToken: /\\w/,\r\n          annotateScrollbar: true,\r\n        },\r\n      },\r\n    };\r\n  },\r\n  components: {\r\n    PanelTitle,\r\n    codemirror,\r\n  },\r\n  created() {\r\n    this.getProjectTree(this.projectName);\r\n  },\r\n  methods: {\r\n    getProjectTree(name) {\r\n      // 获取目录树\r\n      this.$http\r\n        .get(\r\n          this.formatString(this.$store.state.url.project.tree, {\r\n            name: name,\r\n          })\r\n        )\r\n        .then(({ data: tree }) => {\r\n          this.tree = tree;\r\n          if (this.tree.length > 0) {\r\n            let lastNode = this.tree[this.tree.length - 1];\r\n            this.onNodeClick(lastNode);\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.$message.error(this.$store.getters.$lang.messages.errorLoad);\r\n        });\r\n    },\r\n    onNodeClick(data) {\r\n      this.activeNode = data;\r\n      this.onChangeCode(data);\r\n      this.activeFile = this.join(this.activeNode.path, this.activeNode.label);\r\n    },\r\n    // 呈现代码\r\n    onChangeCode(data) {\r\n      // 获取后缀\r\n      let group = this.activeNode.label.split(\".\");\r\n      let extension = group[group.length - 1];\r\n      // 设置Mode\r\n      this.editorOptions.mode = this.modeMap[extension];\r\n      // 加载文件\r\n      if (!data.children) {\r\n        this.$http\r\n          .post(this.$store.state.url.project.fileRead, data)\r\n          .then(({ data: code }) => {\r\n            this.code = code;\r\n          })\r\n          .catch(() => {\r\n            this.$message.error(this.$store.getters.$lang.messages.errorLoad);\r\n          });\r\n      }\r\n    },\r\n    onRenameFile() {\r\n      this.$prompt(\r\n        this.$store.getters.$lang.titles.renameFile,\r\n        this.$store.getters.$lang.buttons.confirm,\r\n        {\r\n          confirmButtonText: this.$store.getters.$lang.buttons.yes,\r\n          cancelButtonText: this.$store.getters.$lang.buttons.no,\r\n          inputValue: this.activeNode.label,\r\n          inputPattern: /[^/\\s]/,\r\n          inputErrorMessage: this.$store.getters.$lang.messages.errorFormat,\r\n        }\r\n      ).then(({ value }) => {\r\n        this.$http\r\n          .post(this.$store.state.url.project.fileRename, {\r\n            path: this.activeNode.path,\r\n            pre: this.activeNode.label,\r\n            new: value,\r\n          })\r\n          .then(() => {\r\n            this.$message.success(\r\n              this.$store.getters.$lang.messages.successSave\r\n            );\r\n            this.getProjectTree(this.projectName);\r\n          })\r\n          .catch(() => {\r\n            this.$message.error(this.$store.getters.$lang.messages.errorSave);\r\n          });\r\n      });\r\n    },\r\n    onCreateFile() {\r\n      this.$prompt(\r\n        this.$store.getters.$lang.titles.createFile,\r\n        this.$store.getters.$lang.buttons.confirm,\r\n        {\r\n          confirmButtonText: this.$store.getters.$lang.buttons.yes,\r\n          cancelButtonText: this.$store.getters.$lang.buttons.no,\r\n          inputValue: this.activeNode.label,\r\n          inputPattern: /[^/\\s]/,\r\n          inputErrorMessage: this.$store.getters.$lang.messages.errorFormat,\r\n        }\r\n      ).then(({ value }) => {\r\n        this.$http\r\n          .post(this.$store.state.url.project.fileCreate, {\r\n            path: this.activeNode.path,\r\n            name: value,\r\n          })\r\n          .then(() => {\r\n            this.$message.success(\r\n              this.$store.getters.$lang.messages.successSave\r\n            );\r\n            this.getProjectTree(this.projectName);\r\n          })\r\n          .catch(() => {\r\n            this.$message.error(this.$store.getters.$lang.messages.errorSave);\r\n          });\r\n      });\r\n    },\r\n    onDeleteFile() {\r\n      this.$confirm(\r\n        this.$store.getters.$lang.messages.confirm,\r\n        this.$store.getters.$lang.buttons.confirm,\r\n        {\r\n          confirmButtonText: this.$store.getters.$lang.buttons.yes,\r\n          cancelButtonText: this.$store.getters.$lang.buttons.no,\r\n          type: \"warning\",\r\n        }\r\n      ).then(() => {\r\n        this.$http\r\n          .post(this.$store.state.url.project.fileDelete, {\r\n            path: this.activeNode.path,\r\n            label: this.activeNode.label,\r\n          })\r\n          .then(() => {\r\n            this.$message.success(\r\n              this.$store.getters.$lang.messages.successDelete\r\n            );\r\n            this.getProjectTree(this.projectName);\r\n          })\r\n          .catch(() => {\r\n            this.$message.error(this.$store.getters.$lang.messages.errorDelete);\r\n          });\r\n      });\r\n    },\r\n    onEditorCodeChange(code, callback) {\r\n      this.$http\r\n        .post(this.$store.state.url.project.fileUpdate, {\r\n          code: code,\r\n          path: this.activeNode[\"path\"],\r\n          label: this.activeNode[\"label\"],\r\n        })\r\n        .then(() => {\r\n          if (callback) {\r\n            callback();\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.$message.error(this.$store.getters.$lang.messages.errorDelete);\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.CodeMirror {\r\n  font-size: 16px;\r\n  height: 76vh;\r\n  z-index: 0;\r\n}\r\n\r\n#tree {\r\n  .panel-body {\r\n    overflow: hidden;\r\n  }\r\n  .el-tree {\r\n    overflow-x: scroll;\r\n    height: 76vh;\r\n    border: none;\r\n    div[role=\"treeitem\"] {\r\n      .el-tree-node__content {\r\n        height: 35px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.el-tree-node.is-current {\r\n  background: #eee;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Edit.vue?vue&type=template&id=547e4f38&\"\nimport script from \"./Edit.vue?vue&type=script&lang=js&\"\nexport * from \"./Edit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Edit.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}